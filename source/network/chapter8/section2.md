## 8.2 密码学

### 8.2.1 对称密钥密码体系
在这种加密方式中，两者的密钥是相同并且秘密的。最早的凯撒密码，变成单码代替密码，后来又演变成多码代替密码。而如今，对称加密技术的方式主要分为两种，一种是流密码，一种是块密码。

#### 8.2.1.1 块密码

块密码用于多种因特网协议的加密中，包括PGP(用于安全电子邮件)、SSL(用于使TCP连接更安全)、IPsec(网络层传输安全)。块密码中，要加密的报文被处理成k个比特的块，每一块单独加密。

用一个例子理解，假设k=3，因此块密码将3比特输入映射为3比特输出，下面是一种可能的映射：
|输入|输出|输入|输出|
|---|----|----|----|
|000|110|100|011|
|001|111|101|010|
|010|101|110|000|
|011|100|111|001|

为了防范暴力破解，块密码通常使用非常大的块，由64比特甚至更多比特组成，这样映射的数量是指数级，组成的可能性也是指数级。但是，上述这种方式需要通信双方都维护一张非常大的映射表，如果改变密钥需要重新生成该表，这是一项庞大且不可能的任务。因此，块密码通常使用函数模拟随机排列表。

常见的块密码加密包括DES，3DES和AES。

#### 8.2.1.2 块密码链接

### 8.2.2 公开密钥密码体系

当使用公钥私钥这种非对称加密体系后，所有人都知道通信对方的公钥，用公钥进行加密，而只有自己才拥有私钥，使用私钥解密。在这个情境下，由于所有人都知道公钥，因此任何一个人都可以向接收方发送报文，因此需要数字签名。（对称加密中，由于密钥仅通信双方持有，因此隐含了身份认证）。

#### 8.2.2.1 RSA

RSA算法几乎就是非对称加密的代名词，RSA算法的工作原理是基于以下一个事实：
```
[(a mod n) + (b mod n)] mod n = (a+b) mod n
[(a mod n) - (b mod n)] mod n = (a-b) mod n
[(a mod n) * (b mod n)] mod n = (a*b) mod n

推出
(a mod n)^d mod n = a^dmod n
```

生成RSA公钥和私钥的步骤如下：
1. 选择两个大素数`p`和`q`。
2. 计算`n=pq`和`z=(p-1)(q-1)`
3. 选择一个小于`n`的数`e`，使得`e`和`z`没有公因数，`e`用于加密。
4. 求数`d`使得`ed mod z = 1`，使用`d`解密。

公钥是`(n,e)`而私钥是`(n,d)`.

明文是`m`，密文是`c`，加密和解密的过程如下：
1. 加密：
   
   `c = m^e mod n`
2. 解密：
   
   `m = c^d mod n`

#### 8.2.2.2 会话密钥

实际中，RSA的运算非常耗费时间，而DES算法则更快，因此通信双方一般使用两者结合。先使用RSA传输用于加密数据本身的密钥，这个密钥也就称为**会话密钥**，之后使用会话密钥来进行对称加密通信。