## 6.1 资源

首先，绝大部分死锁和资源有关系。在进程对设备、文件等取得排他性访问权限时，就有可能出现死锁。我们把这类需要排他性使用的对象称为资源。

### 6.1.1 可抢占资源和不可抢占资源

资源分为两类，可抢占和不可抢占。**可抢占资源**可以从拥有它的进程中抢占而不会产生任何副作用，存储器就是这一类可抢占资源。

**不可抢占资源**是指，在不引起相关的计算失败的情况下，无法把它从占有它的进程处抢占过来。

使用一个资源所需要的事件顺序可以用抽象的形式表示如下：
1. 请求资源
2. 使用资源
3. 释放资源

### 6.1.2 资源获取
对于数据库系统中的记录这类资源，一般是用户进程来管理使用。一种允许用户管理资源的方法是为每一个资源配置一个信号量，用down操作获取资源，up操作释放资源。

当只有一个进程参与，是不会出现问题的。但是如果有多个进程参与，就会产生竞争，从而就可能产生死锁。

例如以下例子就会产生死锁：

```c
semaphore resource_1;
semaphore resource_2;

void process_A(void){
    down(&resource_1);
    down(&resource_2);
    use_both_resource();
    up(&resource_2);
    up(&resource_1);
}

void process_B(void){
    down(&resource_2);
    down(&resource_1);
    use_both_resource();
    up(&resource_2);
    up(&resource_1);
}
```

